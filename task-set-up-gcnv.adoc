---
sidebar: sidebar 
permalink: task-set-up-gcnv.html 
keywords: setup, set up, api, service account, requirements, permissions, google cloud netapp volumes, gcnv, bluexp. netapp console 
summary: NetApp Consoleには、Google Cloud NetApp Volumes API へのアクセスと、Google Cloud サービス アカウントを介した適切な権限が必要です。 
---
= Google Cloud NetApp Volumesを設定する
:hardbreaks:
:allow-uri-read: 
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ./media/


[role="lead"]
NetApp Consoleには、 Google Cloud サービス アカウントを介した適切な権限が必要です。

NetApp ConsoleがGoogle Cloud プロジェクトにアクセスできるように、次のタスクを完了します。

* 既存のサービス アカウントがない場合は、新しいアカウントを作成してください。
* なりすましのアクセスを許可します。
* 共有プロジェクトに IAM ロールを付与します。




== サービスアカウントを設定する

. Google Cloudコンソールでは、 https://console.cloud.google.com/iam-admin/serviceaccounts["サービスアカウントページに移動します"^] 。
. *プロジェクトを選択*をクリックし、プロジェクトを選択して*開く*をクリックします。
. サービス アカウントを作成するには、次の手順を実行します。
+
.. *サービス アカウントの作成*をクリックします。
.. サービス アカウント名 (フレンドリ表示名) と説明を入力します。
+
Google Cloud Console はこの名前に基づいてサービス アカウント ID を生成します。必要に応じて ID を編集します。後で ID を変更することはできません。

.. *作成して続行*をクリックします。
.. 役割リストから、* Google Cloud NetApp Volumes管理者* または * Google Cloud NetApp閲覧者* の役割を選択します。
.. *続行*を選択します。
.. このサービス アカウントへの偽装アクセスを許可します: credentials-sa@wf-production-netapp.iam.gserviceaccount.com。詳細については、 https://cloud.google.com/iam/docs/create-short-lived-credentials-direct#sa-credentials-jwt["自己署名JSON Web Token（JWT）を作成する"^] 。
+
NetAppが所有するサービス アカウントは、そのサービス アカウントの秘密キーにアクセスすることなくそのサービス アカウントとして動作できるようにする、有効期間の短いアクセス トークンを要求するために使用されます。

.. ページの下部にある [*完了*] をクリックして、次の手順に進みます。






== 共有VPC

サービス アカウントを使用する追加の GCP プロジェクトごとに、次の操作を行います。

. _IAM ページ_ で、プロジェクト ドロップダウン メニューから共有 VPC ホスト プロジェクトを選択します。
. *プリンシパルの追加*をクリックします。
. [新しいプリンシパル] フィールドに、サービス アカウントのメール アドレスを入力します。
. [役割の選択] ドロップダウンから、* Google Cloud NetApp Volumes管理者* 役割を選択します。
. *保存*をクリックします。


詳細な手順については、Google Cloud のドキュメントを参照してください。

* link:https://cloud.google.com/iam/docs/creating-managing-service-accounts["サービス アカウントの作成と管理"^]
* link:https://cloud.google.com/iam/docs/roles-permissions/netapp["Google Cloud NetApp Volumes のロールと権限"^]
* link:https://cloud.google.com/iam/docs/granting-changing-revoking-access["リソースへのアクセスの許可、変更、取り消し"^]




== トラブルシューティング

エラーが発生した場合は、*iam.disableCrossProjectServiceAccountUsage* ポリシーが適用される場合があります。これを修正するには、次の手順を実行します。

. Google Cloud コンソールで、 https://console.cloud.google.com/iam-admin/orgpolicies["組織ポリシーページ"^] 。
. *プロジェクト間のサービス アカウントの使用を無効にする* ポリシーを見つけて無効にします。


.次の手順
link:task-add-roles.html["Google Cloud NetApp Volumes のロールを割り当てる"]。
